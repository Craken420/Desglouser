-------------------------------------------------------------------
TBL:
-------------------------------------------------------------------
    EN CAMPOS:

    TIPO 1)
    <BR>Si(ConDatos(DM0345COMSFamiliasLineasValidasAppDimaVis:DM0345COMSFamiliasLineasValidasAppDimaTbl.Grupo)

    TIPO 2)
    Formula=(DM0235ControladorDepyDispTbl.ImpteparaDispersar)
    ListaParametros1=MaviEmbarqueCasaVis:MaviEmbarqueCasaTbl.ID

-------------------------------------------------------------------
VISTAS:
-------------------------------------------------------------------
    EN COMPONENTES:

    AyudaVista=NivelCobranzaMavi
    ---------------------------------------------------------------
    EN CAMPOS:

    Forma.ActualizarVista(<T>RM0946CxcInfEdoCtasVis<T>)<BR>Forma.ActualizarVista(<T>RM0946CxcInfEdoCtasAcumCteVis<T>)<BR> Forma.ActualizarVista(<T>RM0946CxcInfEdoCtasRutVis<T>)<BR> Forma.ActualizarVista(<T>RM0946CxcInfEdoCtasConRutVis<T>)

-------------------------------------------------------------------
REPORTES:
-------------------------------------------------------------------
    EN COMPONENTES:

    TIPO 1)
        TipoAccion=Reportes
        ClaveAccion=RM0170MaviVentServicredXCelInsRep
    ---------------------------------------------------------------
    EN CAMPOS:

    TIPO 1)
        Expresion=<T>RM0170MaviVentServicredXCelInsRep.rep<T>
    TIPO 2)
        Expresion=asigna(mavi.reporte,<T>RM0167MaviVentCieFactInstRep<T>)
        Asigna(mavi.reporte,<T>MaviAlmReporteResumenCapturaServiciosRep<T>)
        Asigna(Mavi.reporte,<T>MaviFacturasEntregadasXQna2Rep<T>)<BR>Dialogo(<T>MaviNuevaConsultaDlg<T>)
    TIPO 3)
        Expresion=<T>RM0167MaviVentCieFactInstRep.rep V.2009.11.10<T>
    ---------------------------------------------------------------
    DUDAS EN:
    ---------------------------------------------------------------
        C:\Users\lapena\Documents\Luis Angel\Secci√≥n Mavi\Intelisis\Intelisis5000\Reportes MAVI\DM0242EscaneoInventariosRep.rep:
        [Reporte]
        Clave=DM0242EscaneoInventariosRep
        [Vista]
        Icono=0
        Clave=DM0242EscaneoInventariosRep
        Nombre=DM0242EscaneoInventariosRep
        *****
        Singular=MaviInvListexistAlmRep
        *****

-------------------------------------------------------------------
DIALOGOS:
-------------------------------------------------------------------
    EN COMPONENTES:

    TIPO 1)
        TipoAccion=Dialogos
        ClaveAccion=MaviNuevaConsultaDlg

    DUDAS:
    TablaRemota=DM0248Articuloslotedlg
    LlaveLocal=DM0248Articuloslotedlg.idArticulo
    ---------------------------------------------------------------
    EN CAMPOS:

    TIPO 1)
        Dialogo(<T>GenerarVentaConsignacion<T>)<BR>  Entonces Dialogo(<T>GenerarFactura<T>)<BR>
        Dialogo(<T>GenerarSolicitudDevolucion<T>)<BR>
        <BR>     Sino Dialogo(<T>GenerarCxcCobro<T>)<BR>

    ---------------------------------------------------------------
    NOTA:
    ---------------------------------------------------------------
    Puede que solo llame a una variable, se diferencia por que no esta entre <T>
    o puede que sea una variable con un dialogo
    Dialogo(Info.Dialogo)
-------------------------------------------------------------------
FORMAS:
-------------------------------------------------------------------
    EN COMPONENTES:

    TIPO 1)
        TipoAccion=Forma
        ClaveAccion=RM0211AneRecMercFrm
    TIPO 2)
        AyudaForma=NivelCobListaMavi
    TIPO 3)
        FormaPrevia=
    ---------------------------------------------------------------
    EN CAMPOS:

    TIPO 1)
        <BR>OtraForma(<T>DM0345COMSFamiliasLineasValidasAppDimaFrm<T>, Forma.Accion(<T>Actualizar<T>))
        OtraForma(<T>DM0320LayoutAlmFrm<T>,
    TIPO 2)
        Si(Forma(<T>EspecificarCliente<T>),Verdadero, AbortarOperacion)
        Forma(<T>DM0239AgreQuitLineaFrm<T>)
        Forma(<T>EdoPoblacionMAVI<T>)
        forma(<T>ExpRegistroCte<T>)<BR>
    TIPO 3)
        ActualizarForma(<T>RM0988CXCMovimientosFrm<T>)
        
    TIPO 4)
        FormaModal(<T>ArtAlmInstitucionesCategoriafrm<T>)<BR>Fin

    ---------------------------------------------------------------
    DUDAS:
    ---------------------------------------------------------------
        Asigna(Mavi.InvListexistAlmProforma,<T>Sin
        Forma.IrCarpeta(<T>Acceso<T>)<BR>

-------------------------------------------------------------------
SQL:
-------------------------------------------------------------------
    LLAMADAS SQL:
    ---------------------------------------------------------------
        EjecutarSQL:
        -----------------------------------------------------------
            TIPO 1)
                EjecutarSQL(<T>EXEC spActualizaPropreArtFam<T>)
            TIPO 2)
                EJECUTARSQL(<T>spActualizaPropreArtFam<T>)
        -----------------------------------------------------------
        SQL
        -----------------------------------------------------------
            SI(SQL(<T>EXEC spActualizaPropreArtFam<T>)
            ,SQL(<T>EXEC spActualizaPropreArtFam<T>)
            (((SQL(<T>EXEC spActualizaPropreArtFam<T>)
            si<BR>      sql(<T>EXEC spActualizaPropreArtFam<T>)
            <T>+SQL(<T>EXEC spActualizaPropreArtFam<T>)
        -----------------------------------------------------------
        ProcesarSQL
        -----------------------------------------------------------
            Entonces ProcesarSQL(<T>EXEC spActualizaPropreArtFam<T>)
        -----------------------------------------------------------
        SQLEnLista
        -----------------------------------------------------------
            SQLEnLista(<T>EXEC spActualizaPropreArtFam<T>)
        -----------------------------------------------------------
        EjecutarSQLAnimado
        -----------------------------------------------------------
            <BR>EjecutarSQLAnimado(<T>EXEC spActualizaPropreArtFam<T>)
        -----------------------------------------------------------
        FormulaSQL
        -----------------------------------------------------------
            Tipo-calculo = De la misma vista
            FormulaSQL=SELECT dbo.fnDiasVencidosCXCMavi(Cxc.ID)

    ---------------------------------------------------------------
    FUNCIONES:
    ---------------------------------------------------------------
        TIPO 1)
            SQL(<T>Select dbo.fn_MaviDM0169validaMovDinero(:nID)<T>,Dinero:Dinero.ID) = 1<BR>   
        TIPO 2)
            from  dbo.FN_DM0255ValidaUEN (:tusuario)<T>,  Usuario),  BotonSi ) =  BotonSi<BR>           Enton<CONTINUA>
    ---------------------------------------------------------------
    SP:
    ---------------------------------------------------------------
        TIPO 1)
            <BR>ejecutarsql(<T>SP_MaviAngelos<T>)<BR>
        TIPO 2)
            EjecutarSQL(<T>spContSATDineroActualizarCtaDineroRfc :nID<T>, 3)
            <BR>EjecutarSQL(<T>spListaStBorrar :nEstacion<T>, EstacionTrabajo)
            EjecutarSQL(<T>EXEC SpCREDIPosiblesBeneficiariosFinalesPlus :nOpcion, :nSpid, :tParametros<T>,1)
            SQL(<T>exec SP_MaviDM0268ValidaTipoContacto :nId<T>,Info.IDMAVI))
            SQL(<T>exec SP_MaviDM0268ValidaTipoContacto :nId<T>,Info.IDMAVI))
            SQL(<T>spValidarFamilia_MAVI :nIDM<T>)
        TIPO 3)
            SQL(<T>EXEC SP_DM0235VentasCanaltruncate<T>)
        TIPO 4)
            EjecutarSQL(<T>xpVentaAutoProcesar :nID<T>, Venta:Venta.ID)
            SQL(<T>EXEC SHM_InsertImporte_Cte :nid<T>, Venta:Venta.ID)

        NOTAS:
        Comentario cortado provoca palabra sp
            AntesExpresiones003=<CONTINUA>spues del cobro
    ---------------------------------------------------------------
    TABLAS:
    ---------------------------------------------------------------
        FROM
        -----------------------------------------------------------
            SQL(<T>Select Mov From Embarque Where Mov = :tEmb<T>,Mavi.RM0229EmbMovTipo)<>Nulo,Verdadero,Falso)
            (SQL(<T>Select Mov+MovID From Embarque Where Mov = :tEmb And MovID=:tID<T>,Mavi.RM0229EmbMovTipo,Mavi.RM0229MovEmbarque)<>Nulo,Verdadero,Falso)
            (SQL(<T>SELECT Vehiculo FROM Vehiculo Where Vehiculo=:Vh<T>,Mavi.RM0229Vehiculos)<>Nulo,Verdadero,Falso)
            (SQL(<T>Select Ruta From Ruta Where Ruta = :tRta<T>,Mavi.RM0229RutaDestinos)<>Nulo,Verdadero,Falso)
        -----------------------------------------------------------
        JOIN
        -----------------------------------------------------------
            A(SQL(<T>Select Articulo FROM Art JOIN ArtLinea ON 
        -----------------------------------------------------------
        INNER JOIN
        -----------------------------------------------------------
            FROM DM0214ZonasCobranza ZC WITH (NOLOCK) INNER JOIN Agente A ON ZC.Agente
        -----------------------------------------------------------
        SUBCOPNSULTAS
        -----------------------------------------------------------
        Estar atento a las subconsultas:
        Intelisis3100\Reportes MAVI\Cxc_FRM_MAVI.esp
            SI (SQL(<T>Select SUM(Revisa)<BR>From<BR>(--F<BR>Select Case When Count(ISNULL(c1.id,0)) != Totmovinc OR Difimpo >0 THEN 1 ELSE 0 END Revisa<BR> FROM<BR> (--A<BR>  Select Padremavi,padreidmavi,COUNT(id) Totmovinc, SUM( CASE WHEN ISNULL(c.Saldo,0) != ISNULL(D.Importe,0) OR c.id IS NULL THEN 1 ELSE 0 END ) Difimpo<BR>  FRom<BR>   (--D<BR>       Select Aplica,Aplicaid,importe<BR>       From<BR>       CXCD<BR>        Where ID = :Nid<BR>        Group by Aplica,Aplicaid,importe<BR>    )D<BR>    Left join CXC C on D.aplica = c.mov<BR>    AND D.aplicaid = c.movid AND  c.Estatus =   <T>+ Comillas(<T>Pendiente<T>)+<BR>   <T>  GROUP BY Padremavi,padreidmavi<BR><BR>   )A<BR>   left join cxc c1 on  c1.padremavi =  A.padremavi and c1.padreidmavi = A.padreidmavi<BR>    AND Estatus = <T>+ Comillas(<T>Pendiente<T>)+<BR>  <T> GROUP BY A.Padremavi,A.padreidmavi, A.Totmovinc,A.Difimpo<BR>   )F <T>, Cxc:Cxc.ID)>0 )<BR><BR>  ENTONCES<BR>    precaucion(<T>Falta incluir alguno de los movimientos del Padre<BR>     o los importes no corresponde con el saldo<T>)<BR>    Abortaroperacion<BR> SINO<BR>  si (SQL(<T>Select Sum(importe) from cxcd where id = :Nid<T>,Cxc:Cxc.ID)<> Cxc:Cxc.Importe + Cxc:Cxc.Impuestos)<BR>    Entonces<BR> 
            Revisa<BR> FROM<BR> (--A<BR>  Select Padremavi,padreidmavi,COUNT(id) Totmovinc, SUM( CASE WHEN ISNULL(c.Saldo,0) != ISNULL(D.Importe,0) OR c.id IS NULL THEN 1 ELSE 0 END ) Difimpo<BR>  FRom<BR>   (--D<BR>       Select Aplica,Aplicaid,importe<BR>       From<BR>       CXCD<BR>        Where ID = :Nid<BR>        Group by Aplica,Aplicaid,importe<BR>    )D<BR>    Left join CXC C on D.aplica = c.mov<BR>    AND D.aplicaid = c.movid AND  c.Estatus =   <T>+ Comillas(<T>Pendiente<T>)+<BR>   <T>  GROUP BY Padremavi,padreidmavi<BR><BR>   )A<BR>   left join cxc c1 on
            Si (SQL(<T>SELECT Categoria FROM dbo.VentasCanalMAVI WHERE ID=:tI<T>,Cxc:Cxc.ClienteEnviarA)<>
            Si (SQL(<T>SELECT ID = COUNT(ID) FROM dbo.CxcD D WITH(NOLOCK) JOIN dbo.MovTipo M WITH(NOLOCK) ON M.Mov=D.Aplica AND M.Clave=:tC AND D.ID=:tI<T>,<T>CXC.NC<T>,Cxc:Cxc.ID)<>0)<BR> 
            <T>)y(SQL(<T>SELECT Categoria FROM dbo.VentasCanalMAVI WHERE ID=:tI<T>
            (SQL(<T>SELECT COUNT(D.ID)N FROM dbo.CxcD D JOIN dbo.Cxc C ON D.Aplica=C.Mov AND D.AplicaID=C.MovID AND D.ID=:tI AND 
            (SQL(<T>SELECT C.Mov FROM Cxc C JOIN Cxc C1 ON C.PadreMAVI=C1.Mov AND C.PadreIDMAVI=C1.MovID JOIN TcIDM0224_ConfigNotasEspejo N ON C1.Mov=N.MovCargo
            SELECT C.Mov FROM Cxc C JOIN TcIDM0224_ConfigNotasEspejo N ON C.Mov=N.MovCredito
            (SQL(<T>SELECT C.Mov FROM Cxc C JOIN Cxc C1 ON C1.ID=CASE WHEN PATINDEX(<T>&Comillas(<T>%[_]%<T>)&<T>,C.Referencia)>0 THEN SUBSTRING(C.Referencia,1,PATINDEX(<T>&Comillas(<T>%[_]%<T>)&<T>,C.Referencia)-1) END JOIN TcIDM0224_ConfigNotasEspejo N ON C1.Mov=N.MovCargo

       


PLUG-INS:
    Ejecutar(<T>PlugIns\DM0305ValidaTelefono.exe <T>+Venta:Venta.Cliente+<T>
    Credito<T>),Ejecutar(<T>PlugIns\DM0221LiberadorAuto.exe <T> +
    )<BR>                                  Ejecutar(<T>PlugIns\RutaTicket.exe <T>+<T>SHM<T>+<T>
    <BR>                                     Ejecutar(<T>C:\AppsMavi\SHM\SHM.exe <T>+Usuario+<T>
    Ejecutar(<T>PlugIns\RutaTicket.exe <T>+<T>SHM3<T>+<T>
    Ejecutar(<T>C:\AppsMavi\SHM\SHM.exe <T>+<T>CLIENTEFINAL<T>+<T>
    <BR>entonces<BR>Ejecutar(<T>PlugIns\italika\Italika.exe <T>+<T>3<T>+<T>
    Ejecutar(<T>PlugIns\ActualizaEcommers.exe<T>+<T>
    <BR>     Ejecutar(<T>PlugIns\RutaTicket.exe <T>+
    <BR>      Ejecutar(<T>C:\AppsMavi\SHM\SHM.exe MACH <T>



VARIABLES:
    ASIGNA
        Asigna(Mavi.DM0239Filtros,NULO)
        Asigna(Temp.Fecha, ExtraeFecha(Vacio(Vencimiento, FechaEmision)))
        Asigna(Info.Ano, Dinero:Dinero.ID )
        <BR>Asigna(Acceso:Acceso.Contrasena,MD5(Acceso:Acceso.Contrasena))
        Asigna(Info.SumaSerieLote si SQL(<T>exec
        Asigna(Info.Ano, Dinero:Dinero.ID )       
        Asigna(Afectar.FormaCaptura, <T>Venta<T>)<BR>
        Asigna(Mavi.DM0209CxcUsuario,Usuario)<BR>    
        Asigna( Info.Mov, Cxc:Cxc.Mov )
        Asigna(Mavi.DM0345Bandera,Mavi.DM0345Bandera+1)
        ASIGNA(Mavi.DM0192CERRAR,FALSO)<BR> 
        Asigna(Acceso:Acceso.Contrasena,MD5(Acceso:Acceso.Contrasena))
        asigna(Mavi.DM0192SelImporte,nulo)
    CONDATOS
        <BR>Si(ConDatos(Temp.Fecha), Hoy-Temp.Fecha)
        (ConDatos(Mavi.ArtAlmGruposAlmacen)

    DM0285VTASAgrupaFamilia<BR>DM0285FamiliaLinea
    Suma(VentaD:ImporteTotal), Config.VentaCobroRedondeoDecimales)
    Vacio(Info.EntregasMinMAVI,0)
    Cont.Mov+<T> <T>+Cont.MovID
    SI Info.Clave = <T>DM0214cambioDivision<T><BR><BR>entonces<BR>
    sqlenlista(<T>Select division from dm0214divisiones<T> )<BR>Sino
    DescribirOpciones( InvD.SubCuenta )
    UnidadesArticulo(InvD.Articulo)
    <BR>SI MAVI.DM0268ValidaMensajeError<>
    <BR>SI MAVI.DM0268ValidaMensajeError<><T>Permite<T><BR>Entonces<BR> 
    informacion(MAVI.DM0268ValidaMensajeError)<BR>
    SQL(<T>select Descripcion1 from Art where Articulo=<T>+Comillas(Mavi.DM0320Articulo))))
    Forma.Accion(<T>CargarInfo<T>)
    Fechaformatoservidor(Info.FechaD)
